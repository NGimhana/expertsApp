<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Expert Instructions</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 40px;
      background-color: #f4f4f4;
      color: #333;
    }
    .instructions {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 6px;
      border: none;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
      box-shadow: 0 0 10px #4CAF50;
      animation: glowPulse 1.5s infinite alternate;
    }
    @keyframes glowPulse {
      0% { box-shadow: 0 0 10px #4CAF50; }
      100% { box-shadow: 0 0 20px #4CAF50, 0 0 30px #4CAF50; }
    }
    button:hover {
      background-color: #45a049;
    }
    a {
      color: #4CAF50;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }

    .steps-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 16px;
  }
  .steps-table td {
    padding: 12px;
    vertical-align: top;
  }
  .step-number {
    background-color: #f4c542;
    font-weight: bold;
    width: 40px;
    text-align: center;
    border-radius: 6px;
  }
  .step-desc {
    background-color: #fff7e6;
  }
  .step-time {
    background-color: #f4c542;
    text-align: center;
    font-weight: bold;
    border-radius: 6px;
    width: 80px;
  }
  </style>
</head>
<body>

<div class="instructions">
  <h2>Welcome and Overview</h2>
  <p>Thank you for agreeing to contribute your expertise to this research study. Your input will help establish a reliable ground truth for code snippet comprehensibility, which is essential for evaluating and improving the proxies used to predict code comprehension. While prior research has often relied on undergraduate computer science students as stand-ins for professional developers, this study uses your expert judgments to evaluate the reliability of such proxies. Please carefully follow the instructions and protocol outlined below.</p>

    <p><strong>Please use a desktop or laptop computer (not a mobile device) to complete this study.</strong> The interface involves drag-and-drop interactions and viewing multiple code snippets side by side, which works best on a full screen.</p>

    <p>We also use cookies and session storage to save your progress locally between phases. If you prefer not to use cookies, you may complete the study in an incognito/private browsing window (note: this disables local saving).</p>

  <h3>Definitions</h3>
  <p><strong>What is Code Comprehensibility?</strong><br>
  In this study, we define code comprehensibility as the extent to which experienced developers perceive a code snippet to be easy to understand in terms of its functionality and purpose. There is no universally accepted definition, so your perspective as an expert is crucial.</p>

  <p><strong>What is a Code Snippet?</strong><br>
  A code snippet in this study, refers to a small, self-contained Java method sourced from real-world, high-quality repositories. Each snippet is independent of the others. There are a total of 8 code snippets in this study.</p>

  <h3>Study Design</h3>
  <p>Our goal is to develop an expert-determined ranking of code snippet comprehensibility. This ranking will serve as the ground truth for a larger study.</p>
  <p>To reduce bias and ensure validity, we invited multiple experts, including yourself, to complete the same tasks. We use a structured protocol based on the <a href="https://en.wikipedia.org/wiki/Delphi_method" target="_blank">Delphi method</a>, a technique designed to aggregate expert consensus through multiple rounds.</p>

<p><strong>Protocol Overview:</strong></p>
<ul>
<li>You will complete three main tasks involving all 8 code snippets:
  <ul>
    <li><strong>Phase 1:</strong> Review and summarize each code snippet, including a brief explanation of its comprehensibility.</li>
    <li><strong>Phase 2:</strong> Rank all 8 snippets based on how comprehensible you find them, using a flexible drag-and-drop interface. Snippets with similar comprehensibility can be grouped in the same rank.</li>
    <li><strong>Phase 3:</strong> Provide reasoning for your rankings, including why certain snippets were grouped together and why some were placed higher than others.</li>
  </ul>
  Together, these phases should take approximately one hour to complete.
  </li>
  <li>After all submissions are received, we will analyze the expert rankings.</li>
  <li>If unanimous agreement on the rankings is reached, the study will conclude.</li>
  <li>If not, we will initiate follow-up rounds and share anonymized feedback from other experts.</li>
  <li>You will have the opportunity to review and optionally revise your rankings based on this feedback.</li>
  <li>We may repeat this process for up to three rounds.</li>
  <li>If full consensus is still not reached, we will use statistical aggregation to produce the final ground truth.</li>
  <li>We may revise or replace certain snippets if experts report difficulties in distinguishing them based on comprehensibility.</li>
</ul>

<h3>Step-by-Step Procedure</h3>
<p>You will complete these main tasks involving all 8 code snippets:</p>
<table class="steps-table">
  <tr>
    <th style="width: 100px;">Phase</th>
    <th>Description</th>
    <th style="width: 100px;">Time</th>
  </tr>
  <tr>
    <td class="step-number">Phase 1</td>
    <td class="step-desc">
      Carefully review each code snippet. Reflect on its purpose and how understandable it is. Provide a brief summary and your assessment of its clarity.
    </td>
    <td class="step-time">20 mins</td>
  </tr>
  <tr>
    <td class="step-number">Phase 2</td>
    <td class="step-desc">
      Rank all snippets from most to least comprehensible using a drag-and-drop interface. You may group snippets if their comprehensibility feels similar.
    </td>
    <td class="step-time">15 mins</td>
  </tr>
  <tr>
    <td class="step-number">Phase 3</td>
    <td class="step-desc">
      Explain your ranking decisions. Describe why certain snippets were grouped and how you distinguished one level of clarity from another.
    </td>
    <td class="step-time">15 mins</td>
  </tr>
  <tr>
    <td class="step-number">Submission</td>
    <td class="step-desc">
      Review and submit your responses. You may revisit and update your answers any time before the submission deadline.
    </td>
    <td class="step-time">5 mins</td>
  </tr>
</table>

<p><strong>Estimated Total Time:</strong> ~55 minutes</p>




<h2>Study Overview</h2>

<p>Our goal is to develop an expert-determined ranking of code snippet comprehensibility. This ranking will serve as the ground truth for a larger study on software comprehension.</p>

<p>To reduce bias and improve reliability, we invited multiple experts — including you — to complete the same task set. We follow a structured protocol inspired by the <a href="https://en.wikipedia.org/wiki/Delphi_method" target="_blank">Delphi method</a>, which aggregates expert consensus through multiple rounds.</p>

<h3>What You'll Do</h3>
<p>The study consists of three main phases. Your total time commitment is approximately <strong>55 minutes</strong>.</p>

<table class="steps-table">
  <tr>
    <th style="width: 100px;">Phase</th>
    <th>Description</th>
    <th style="width: 100px;">Time</th>
  </tr>
  <tr>
    <td class="step-number">Phase 1</td>
    <td class="step-desc">
      Review each code snippet and provide a short summary along with your assessment of how understandable it is.
    </td>
    <td class="step-time">20 mins</td>
  </tr>
  <tr>
    <td class="step-number">Phase 2</td>
    <td class="step-desc">
      Rank the snippets from most to least comprehensible. You can group snippets that feel equally understandable.
    </td>
    <td class="step-time">15 mins</td>
  </tr>
  <tr>
    <td class="step-number">Phase 3</td>
    <td class="step-desc">
      Explain your reasoning behind the rankings. Describe why snippets were grouped and how you compared them.
    </td>
    <td class="step-time">15 mins</td>
  </tr>
  <tr>
    <td class="step-number">Submission</td>
    <td class="step-desc">
      Review and submit your answers. You may revise and resubmit anytime before the deadline.
    </td>
    <td class="step-time">5 mins</td>
  </tr>
</table>

<h3>What Happens Next</h3>
<ul>
  <li>After all submissions are received, we will analyze the expert rankings.</li>
  <li>If unanimous agreement is reached, the study will conclude.</li>
  <li>If not, we will initiate follow-up rounds with anonymized feedback from peers.</li>
  <li>You may revise your rankings based on this feedback.</li>
  <li>We may conduct up to three rounds of feedback and refinement.</li>
  <li>If consensus is still not achieved, we will use statistical aggregation to finalize the results.</li>
  <li>We may revise or replace code snippets that experts report as too similar to distinguish.</li>
</ul>

<h3>Submission Deadline</h3>
<p><strong>All responses must be submitted by <span style="color: #d32f2f;">May 20, 2025</span>.</strong><br>
Please ensure you complete all phases by the deadline so your input can be included in the final analysis.</p>

<h3>Definitions</h3>
<div style="background: #f0f8ff; border-left: 4px solid #4CAF50; padding: 15px; margin-bottom: 20px;">
  <p><strong>Code Comprehensibility</strong>: How easy a snippet is to understand, as judged by experienced developers. This includes clarity of structure, naming, and logic. There is no single standard — your expert perspective defines it.</p>
  <p><strong>Code Snippet</strong>: A small, self-contained Java method drawn from real-world open-source projects. All 8 snippets are independent and carefully selected.</p>
</div>




  <h3>Submission Deadline</h3>
  <p><strong>All responses must be submitted by <span style="color: #d32f2f;">May 20, 2025</span>.</strong><br>
  Please ensure you complete both phases by the deadline so your input can be included in the final analysis.</p>

  <h3>Next Step</h3>
<!-- Login Section -->
<form id="login-box" onsubmit="return loginAndProceed(event)" autocomplete="on">
  <h3>Login to Begin</h3>
  <p><strong>Please enter your username and password to start the study:</strong></p>

  <input type="text" id="username" name="username" placeholder="Username" autocomplete="username"
         style="padding: 8px; font-size: 16px; width: 300px; border-radius: 5px; border: 1px solid #ccc;"><br><br>

  <input type="password" id="password" name="password" placeholder="Password" autocomplete="current-password"
         style="padding: 8px; font-size: 16px; width: 300px; border-radius: 5px; border: 1px solid #ccc;"><br>

  <p id="login-error" style="color: red; display: none;"></p>

  <p style="margin-top: 20px;">
    <button type="submit">Login and Start Phase 1</button>
  </p>
</form>


<!-- Post-login Proceed Button -->
<div id="proceed-box" style="display: none; margin-top: 20px;">
  <p>Welcome back, <span id="participant-display-name" style="font-weight: bold;"></span>!</p>
  <button onclick="proceedToPhase1()">Proceed to Phase 1</button>
</div>


</div>


<footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ccc; text-align: center; font-size: 14px; color: #666;">
  Please contact us if you have any questions or issues: <a href="mailto:ea442@njit.edu">ea442@njit.edu</a>
</footer>


<script>
  function setCookie(name, value, days = 30) {
    const expires = new Date(Date.now() + days * 864e5).toUTCString();
    document.cookie = `${name}=${encodeURIComponent(value)}; path=/; expires=${expires}`;
  }
  
  async function loginAndProceed(event) {
  event.preventDefault();

  const username = document.getElementById('username').value.trim().toLowerCase();
  const password = document.getElementById('password').value.trim();
  const errorDiv = document.getElementById('login-error');
  errorDiv.style.display = 'none';

  if (!username || !password) {
    errorDiv.textContent = "Please enter both username and password.";
    errorDiv.style.display = 'block';
    return;
  }

  try {
    const response = await fetch('https://codecomprehensibility.site/get_snippet_order', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password })
    });

    if (!response.ok) throw new Error("Invalid credentials");

    const data = await response.json();
    const { participantName, snippetOrder } = data;

    if (!participantName || !snippetOrder) throw new Error("Incomplete response");

    sessionStorage.setItem('participantName', participantName);
    sessionStorage.setItem('snippetOrder', JSON.stringify(snippetOrder));
    sessionStorage.setItem('username', username);

    setCookie('participantName', participantName);
    setCookie('snippetOrder', JSON.stringify(snippetOrder));
    setCookie('username', username);

    window.location.href = 'phase1.html';

  } catch (err) {
    console.error(err);
    errorDiv.textContent = "Login failed. Please check your credentials.";
    errorDiv.style.display = 'block';
  }
}

  </script>
  

<script>
  function getCookie(name) {
    const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
    return match ? decodeURIComponent(match[2]) : null;
  }

  function isLoggedIn() {
    const name = sessionStorage.getItem('participantName') || getCookie('participantName');
    const order = sessionStorage.getItem('snippetOrder') || getCookie('snippetOrder');
    return name && order;
  }

  window.onload = () => {
    if (isLoggedIn()) {
      const name = sessionStorage.getItem('participantName') || getCookie('participantName');
      document.getElementById('login-box').style.display = 'none';
      document.getElementById('proceed-box').style.display = 'block';
      document.getElementById('participant-display-name').textContent = name;
    }
  };

  function proceedToPhase1() {
    window.location.href = 'phase1.html';
  }
</script>

</body>
</html>